# 表紙
題目：低コスト移動体における視覚と言語を扱う大規模モデル単体制御の初期評価と課題抽出
所属：明治大学理工学部（仮）
氏名：
指導教員：
提出日：2025年11月25日

# 目次
1. 序論
2. 手法
3. 実験
4. 結果
5. 考察
6. 結論
7. 謝辞
8. 参考文献
9. 付録

# 1 序論
　近年，画像と文章を同時に扱える大規模モデル（本稿では Vision-Language Model, VLM と呼ぶ）が普及し，ロボットの目標物認識や移動制御への応用が試みられている。SayCan [1] や PaLM-E [2] は大規模言語モデルを計画生成に利用し，RT-2 [3] は画像と言語から直接行動を出力する手法を示した。VL-Maps [4] は事前に意味情報付きの地図を作成し，探索性能を向上させている。これらの研究は高性能である一方，地図作成や外部記憶，階層的な計画など多くの付加機能を伴い，計算資源と準備時間を要する。
　安価な小型移動体では，こうした付加機能を持たない構成が現実的である。しかし，地図を使わず，単一カメラ画像を VLM に入力して「どの方向に進むか」を即時に決めるという簡素な構成の性能や限界は十分に報告されていない。本研究は，OSOYOO Raspberry Pi Car を用い，地図作成や複雑なセンサ統合を行わない構成で，VLM 単体制御がどの程度安定した走行を達成できるかを調べる。タスクは「黄色の TARGET と印字された箱に接近し，前方 20 cm 以内で停止する視覚依存の接近制御」である。ラズパイ上の軽量プログラムが映像転送とモータ駆動を担い，推論は PC で実行する。ロボット側には地図化や自己位置推定を置かず，視覚判断のみに依存する点で低コスト性と実装の単純さを重視する。
　本研究では GPT-5-mini-20250807 を主モデルとして用い，軽量モデル（SmolVLM 系）も補足的に試行する。評価指標は到達時間，成功率，コマンド適合率を主とし，補助指標として左右や前後の即時反転回数，推論遅延分布を記録する。比較条件は次の二つである。(A) VLM が映像を見て直接「前進・旋回・停止」などの移動コマンドを出す方式を本稿では「ダイレクト制御」と呼ぶ。(B) VLM は「ターゲットの左右位置と距離」だけを返し，PC 側の単純な規則でコマンドを決める方式を「ハイブリッド制御」と呼ぶ。両条件とも 1 ループあたり約 5–7 秒の推論遅延があるため，ループ間隔を 10 秒に統一し，VLM が判断で失敗するのか，指令生成で失敗するのかを分離して評価する。
　本研究の貢献は二点である。第一に，付加機能を持たない安価な構成において VLM 単体制御の実環境性能を定量化し，基本的な限界を示す。第二に，失敗事例を解析し，将来の拡張に向けた設計要件を整理する。

# 2 手法
## 2.1 ハードウェア構成
　対象機体は OSOYOO Raspberry Pi Robot Car（2023版）である。Raspberry Pi 4B，広角 USB カメラ，モータドライバ（L298N），ステアリング用サーボから構成し，カメラ解像度は 640×480，フレームレートは 5 fps とする。走行は室内の平坦な床面で行う。

## 2.2 通信とソフトウェア構成
　ラズパイ上で `raspi_agent.py` を 8080 番ポートで起動し，`GET /frame.jpg` と `/stream.mjpg` によるフレーム配信，`POST /command` による `FORWARD/LEFT/RIGHT/BACKWARD/STOP` コマンド受信を提供する。PC 側は同一ネットワークから HTTP でアクセスし，VLM の推論結果に基づきコマンドを送信する。自宅用と研究室用の IP を環境変数で切り替え，実験時の誤接続を防ぐ。

## 2.3 使用モデルとプロンプト
　主モデルは GPT-5-mini-20250807（ローカル実行）である。単一フレームを入力し，「黄色の TARGET 箱に到達して停止せよ」と指示した上で，選択肢を `LEFT/RIGHT/FORWARD/FORWARD_SLOW/STOP/BACKWARD` の一語に限定する。SmolVLM 系モデルも比較のために試行し，結果を付録にまとめる。

## 2.4 制御条件
- 条件A（VLM 直接制御，以下「ダイレクト制御」）: VLM が各ループで移動コマンドを直接選び，そのままロボットへ送信する。推論に 5–7 秒要するため，ループ間隔は 10 秒とし，速度は固定とする。
- 条件B（認識＋規則制御，以下「ハイブリッド制御」）: VLM は「ターゲット位置（LEFT/CENTER/RIGHT）と距離（FAR/MID/NEAR）」だけを JSON 形式で返し，PC 側で単純な規則によりコマンドを決定する。規則は「CENTER なら前進，NEAR なら減速または停止，LEFT/RIGHT なら旋回」とし，こちらも推論遅延を考慮してループ間隔を 10 秒に揃える。
　両条件ともヒステリシスは用いず，VLM 出力と単純規則のみで挙動を決める。

## 2.5 比較観点と改善優先度
　ダイレクト制御とハイブリッド制御の比較により，誤りが生じやすい工程を次の二段階に分けて評価する。まず，VLM が画像から位置と距離を正しく判断できるかをハイブリッド制御で測定し，誤認識が多い場合は入力前処理や照度制御を優先して改善する。次に，判断は正しいがコマンド生成で逆転や過大旋回が起きる場合は，ダイレクト制御のプロンプト設計やコマンド選択肢の絞り込みを優先する。この結果を基に，外部記憶の導入や予測モデルの追加が必要となる箇所（判断工程か指令工程か）を明確にし，拡張設計の順序を定める。

# 3 実験
## 3.1 環境とコース
　室内直線コース（長さ 2.5 m）と L 字コース（1.5 m＋1.5 m）を作成し，照度は 400–500 lx に保つ。壁や障害物は固定し，背景テクスチャを一定にする。ターゲットは黄色の箱に “TARGET” と印字したものを終点に配置する。

## 3.2 手順と試行数
　開始位置はターゲットから約 2.5 m 離し，左右位置や向きを少しずつ変えながら複数回試行する。各条件について各コース 10 試行ずつ，計 40 試行を行う。走行中はフレーム画像，VLM 出力，送信コマンド，タイムスタンプを保存し，別カメラで全体動画を記録する。試行には通し番号を付け，コース種別，照度，モデルバージョン，開始・終了時刻をメタ情報として残す。

## 3.3 評価指標
- 到達時間：開始コマンド送信から停止判定までの時間。
- 成功率：ターゲット前 20 cm 以内で停止した試行の割合。
- コマンド適合率：全送信コマンド中，理想方向・速度に合致すると評価できる割合。
- コマンド反転回数：左右または前後の即時反転の回数。
- 推論遅延：VLM 応答時間の中央値と 95 パーセンタイル。

# 4 結果（暫定）
　直近のログとフレームログには試行ごとの到達可否，コマンド系列，推論遅延が保存されている。現在集計中であり，確定値を表1に示す予定である。表1には各条件・各コースの平均到達時間，成功率，コマンド適合率，反転回数中央値，推論遅延中央値／95 パーセンタイルを記載する。コマンド時系列と軌跡オーバーレイを図1，図2として挿入する計画である。SmolVLM 系モデルは到達率が低く，誤旋回と停止不能が多発したため，詳細を付録Aに記載する。

# 5 考察（予定）
　予備観察では，ダイレクト制御は推論遅延と誤指示によりコマンド反転が増え，到達時間がばらつく傾向があった。ハイブリッド制御は距離推定の粗さが残るものの，左右誤指示の影響を抑え，成功率が高まると見込む。VLM 単体制御の主な課題は，(1) 応答遅延がループ間隔に近いこと，(2) 単一フレーム依存による瞬間的な誤認識，(3) 照度変動への感度である。これらに対し，フレームスタックによる時系列文脈の付与，簡易な外部記憶による状態保持，軽量な予測モデルによる補正が有効と考える。

# 6 結論
　本研究は，低コスト移動体で地図や複雑なセンサ統合を用いない構成において，VLM 単体制御が達成できる性能を評価する枠組みを示した。ダイレクト制御とハイブリッド制御を同条件で比較し，到達時間・成功率・コマンド適合率を中心指標，反転回数と遅延分布を補助指標として計測する計画を立てた。今後，集計したログデータを反映した結果と考察を追記し，外部記憶や予測モデルを組み込む際の具体的な設計指針を示す。

# 7 謝辞
　本研究の遂行にあたり，実験環境整備に協力いただいた研究室メンバー各位に感謝する。計算資源と機材提供に謝意を表する。

# 8 参考文献
[1] A. Brohan et al., “Do As I Can, Not As I Say: Grounding Language in Robotic Affordances,” 2022.
[2] D. Driess et al., “PaLM-E: An Embodied Multimodal Language Model,” 2023.
[3] A. Brohan et al., “RT-2: Vision-Language-Action Models Transfer Web Knowledge to Robotic Control,” 2023.
[4] (Authors), “VL-Maps: Visual-Language Maps for Zero-shot Object Navigation,” 2023.

# 付録A SmolVLM 失敗試行の概要
　SmolVLM2-mlx を用いて同一タスクを試行したところ，推論時間は平均 0.8 s でループ間隔 0.5 s を上回った。その結果，過去フレームに基づく誤指示が頻発し，10 試行中の成功は 2 回に留まった。誤指示の内訳は左右の即時反転 12 件，停止不能 4 件であった。今後はモデルの軽量化またはフレーム間補間の導入を検討する。
